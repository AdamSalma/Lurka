@import '~sass/utils'

$width: 100vw
$height: $header-height + $subheader-height

$ani-bezier: $bezier-fast
$ani-duration: .24s
$ani-delay: .066s
$ani-duration-delayed: $ani-duration - $ani-delay $ani-delay $ani-bezier

$ani-rules: $ani-duration $ani-bezier

=animate($properties...)
    transition: all $ani-rules
    transition-property: $properties

@keyframes RemoveUnderline
    0%
        transform: scaleX(1)
        opacity: 1
    to
        transform: scaleX(1)
        opacity: 0

@keyframes AddUnderline
    0%
        transform: scaleX(0)
    to
        transform: scaleX(1)


.DynamicHeader
    +size($width, $height)
    position: absolute
    background: var(--interfaceColor)
    +position(0, 0)
    z-index: $mainheader-z-index + 1
    transition: height $ani-rules
    background: var(--headerExpanded)
    // box-shadow: 0 2px 4px -1px rgba(0,0,0,0.2), 0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12)

    .content
        display: flex
        +size(inherit)
        flex-direction: row
        // border-bottom: 2px #3f3f3f solid
        padding-left: 2rem

    .vertical-icon
        +clickable
        text-align: center
        font-size: 28px
        padding: 8px
        max-width: 96px

        // TESTING PROPERTIES
        height: 100%
        display: flex
        align-items: center
        // flex-direction: column
        // justify-content: center

        // transition: all $ani-rules, max-width .2s ease-out
        // +animate(max-width, font-size, margin)
        transition: font-size $ani-rules, margin-top $ani-rules, margin-right $ani-rules, max-width $ani-duration + .05s ease-out
        position: relative

        display: flex
        align-items: center
        // left: -.5rem
        position: relative

        .title
            font-size: 13px
            letter-spacing: .07em
            font-family: font-for(DynamicHeader__Title)
            display: block
            color: var(--textSecondary)
            margin-top: -4px

            transition: opacity $ani-duration .2s ease-in
            // transition: opacity $ani-duration .12s ease-out
            opacity: 1

        // &.menu
        //     width: 5rem

    .menu
        margin-left: 1rem !important
        margin-right: 1rem

        // .centered
            // margin-right: 0
            // margin-left: 1rem

    .searchbar-wrapper
        width: 100%
        text-align: left
        padding: 0 2rem
        // height: 1rem
        font-size: 14.5px
        .SearchBarWithIcons
            background: var(--headerSearchbar)



    .FullLogo
        font-family: font-for(DynamicHeader__LogoText)
        padding-left: 1rem
        // padding-right: 1rem
        font-size: 28px
        // transition: all $ani-rules
        +animate(padding, font-size)

        .Logo
            padding: 8px
            transition: padding $ani-rules, margin-right $ani-rules
            margin-right: 12px

        .version
            transition: opacity $ani-rules

        .text
            transition: transform $ani-rules

    .stat
        padding: 0 1em
        font-size: 10.5px

    .title-group
        margin-top: 14px
        letter-spacing: 1px

    .title-group
        font-family: font-for(HeaderTitle)
        // font-size: 28px
        +font-size(3)
        transition: font-size $ani-rules, letter-spacing $ani-rules
        margin: 0 1em
        position: relative

        .main-title
            letter-spacing: .35em

        .Icon
            vertical-align: top
            color: var(--textDisabled)
            // color: var(--primaryLight)
            font-size: 28px

    // Icons next to title in center
    .shrink-icon
        +clickable
        +font-size(2)
        // font-size: 20px
        color: var(--textSecondary)
        opacity: 0
        padding: 0 .5rem
        position: relative
        // top: 17px
        margin: 0 4px
        height: 100%
        display: flex !important
        align-items: center

    .Icon
        vertical-align: -webkit-baseline-middle

    // "Watch" notification icon
    .Notification__content
        top: 0px
        left: 30px

    .hide-on-expanded
        opacity: 0



    .board-action
        padding: 8px
        background: $primary
        border-radius: 4px
        margin: .5rem

        &.first
            margin-left: 1rem




// Applied when user scrolls down
.DynamicHeader.shrink
    height: $header-height
    background: var(--interfaceColor)
    // box-shadow: 0 2px 4px -1px rgba(0,0,0,0.2), 0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12)

    .hide-on-expanded
        opacity: 1

    .main-title
        font-size: 21.5px
        letter-spacing: .25em
        margin: 0
        // margin-top: 21.5px
        // margin-right: 0px
        margin-top: 7px



        .Icon
            display: none !important

        &::before
            display: none

    .vertical-icon
        font-size: 24px
        max-width: 40px
        +animate(max-width, font-size, margin-top, margin-right)
        margin-top: 0px
        margin-right: 16px

        .title
            transition: opacity $ani-rules
            opacity: 0

    .FullLogo
        padding-left: 0
        font-size: 24px

        .logo
            padding: 16px
            padding-right: 16px
            margin-right: 0px

        .text
            transform: translate(0, 18px)

        .version
            opacity: 0

    .shrink-icon
        opacity: 1
        transition: opacity $ani-duration $ani-duration/2 $ani-bezier, color .1s ease-out

    .Notification__content
        left: 26px










// Flex positioning
.DynamicHeader .HeaderGroup
    padding: 0 8px
    transition: padding $key-animation-duration $key-bezier-animation-out
    display: flex
    justify-content: center
    align-items: center
    flex: 1

    &.left
        margin-left: 0
        margin-right: auto
        justify-content: left

        // .Icon
        //     color: $text-secondary
        //     font-size: 21.5px

        > :first-child
            margin-left: 0

        > :last-ch0
            margin-right: auto

    &.right
        padding-right: 1rem
        margin-left: auto

        > :first-child
            margin-left: auto

        > :last-child
            margin-right: 2rem

    &.center
        margin: 0 auto
        text-align: center
        flex: 5

    > *
        display: inline-block


.DynamicHeader .header-button
    height: 100%
    display: flex
    align-items: center
    text-align: center
    padding: 0 1rem

    // min-width: 80px
    position: relative
    cursor: pointer
    // width: 4rem

    // The underline
    &::before
        content: ""
        +size(100%, 2px)
        position: absolute
        bottom: -2px // for border
        left: 0
        right: 0
        z-index: 2
        background: $primary
        transform: scaleX(0)
        animation: RemoveUnderline .3s cubic-bezier(0.4,0,0.2,1)

    &:hover, &.active
        &::before
            transform: scaleX(1)
            animation: AddUnderline .3s cubic-bezier(0.4,0,0.2,1)
        &::after
            opacity: 1

    // The background
    &::after
        transition: opacity .3s ease-out
        content: ""
        position: absolute
        top: 0
        opacity: 0
        left: 0
        right: 0
        $bgc: rgba(104, 48, 48, 0.5)
        background: $bgc
        background-image: linear-gradient(to top, $bgc, transparent 50%)
        height: $header-height + $subheader-height
        z-index: -2

    .Icon
        font-size: 28px

    .header-button-title
        font-size: 14px
        color: $text-secondary
        margin-top: .2rem
        // font-variant: small-caps
        letter-spacing: 1px


.DynamicHeader.shrink .header-button
    // height: 100%

    &::after
        height: $header-height

    .Icon
        font-size: 24px

    .header-button-title
        display: none

    &.menu
        margin-left: -1rem !important
        transition: margin .24s
